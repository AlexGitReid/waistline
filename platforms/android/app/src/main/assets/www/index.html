<!DOCTYPE html>
<!--
  Copyright 2018 David Healey

  This file is part of Waistline.

  Waistline is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Waistline is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with Waistline.  If not, see <http://www.gnu.org/licenses/>.
-->

<html>
    <head>
        <meta http-equiv="Content-Security-Policy" content="default-src * data: gap; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height">
        <meta charset="UTF-8">

        <!-- jQuery mobile theme -->
        <link rel="stylesheet" href="css/themes/blank.css" />
        <link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />
        <link rel="stylesheet" href="css/jquery.mobile.structure-1.4.5.min.css" />

        <!-- jQuerymobile -->
        <script src="js/jquery-1.11.3.min.js"></script>
        <script src="js/jquery.mobile-1.4.5.min.js"></script>

        <!-- Chart JS -->
        <script src="js/Chart.bundle.min.js"></script>

        <!-- My extra styles -->
        <link rel="stylesheet" href="css/styles.css" />
        <title>Waistline</title>
    </head>
    <body>
      <!--Home page -->
      <div data-role="page" id="home">
        <div data-role="header">
          <h1>Waistline</h1>
        </div>
        <div data-role="main" class="ui-content">
          <a data-role="button" id="openDiary" href="#diaryPage" data-localize="diary"></a>
          <a data-role="button" id="openStats" href="#statsPage" data-localize="stats"></a>
          <a data-role="button" id="openFoods" href="#foodListPage" data-localize="food-list"></a>
          <a data-role="button" id="openSettings" href="#settingsPage" data-localize="settings"></a>
          <a data-role="button" id="openGuide" href="#guidePage" data-localize="instructions"></a>
          <a data-role="button" id="openSettings" href="javascript:dbHandler.exportToFile();" data-localize="export"></a>
          <a data-role="button" id="openSettings" href="#importDataPopup" data-rel="popup" data-localize="import"></a>
        </div>
        <div data-role="footer" class="footer" data-position="fixed" data-tap-toggle="false">
          <div id="progress">
            <div class="calorieCount"></div>
          </div>
          <div class="ui-grid-b statusBar"> <!--3 column layout-->
            <div class="ui-block-a heading" data-localize="goal"></div>
            <div class="ui-block-b heading" data-localize="used"></div>
            <div class="ui-block-c heading" data-localize="remaining"></div>
            <div class="ui-block-a stat">0</div>
            <div class="ui-block-b stat">0</div>
            <div class="ui-block-c stat">0</div>
          </div>
        </div>
        <div data-role="popup" id="importDataPopup">
          <div data-role="header">
            <h1 data-localize="import-title"></h1>
          </div>
          <div data-role="main" class="ui-content">
            <p data-localize="confirm-import"></p>
            <form onsubmit="dbHandler.readFromFile();">
              <a data-role="button" id="cancel" data-rel="back" data-localize="cancel"></a>
              <button type="submit" name="import" data-role="button" data-localize="import"></button>
            </form>
          </div>
        </div>
      </div>

      <!--Diary page -->
      <div data-role="page" id="diaryPage">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">
          <a href="index.html" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
          <a href="index.html"></a>
          <h1 data-localize="diary"></h1>
        </div>
        <div data-role="main" class="ui-content">
          <div id="diaryDate"></div>
          <ul data-role="listview" id="diaryListview" data-icon="false"></ul>
        </div>
        <div data-role="footer" class="footer"  data-position="fixed" data-tap-toggle="false">
          <div class="calorieCount"></div>
          <div class="ui-grid-b statusBar"> <!--3 column layout-->
            <div class="ui-block-a heading" data-localize="goal"></div>
            <div class="ui-block-b heading" data-localize="used"></div>
            <div class="ui-block-c heading" data-localize="remaining"></div>
            <div class="ui-block-a stat">0</div>
            <div class="ui-block-b stat">0</div>
            <div class="ui-block-c stat">0</div>
          </div>
        </div>
        <div data-role="popup" id="deleteDiaryListItemPopup">
          <div data-role="header">
            <h1 data-localize="delete-title"></h1>
          </div>
          <div data-role="main" class="ui-content">
            <p data-localize="confirm-delete"></p>
            <a data-role="button" id="cancel" data-rel="back" data-localize="cancel">Cancel</a>
            <button data-role="button" data-localize="delete"></button>
          </div>
        </div>
      </div>

      <!--Diary Item View/Edit Page-->
      <div data-role="page" id="editDiaryItemPage">
        <div data-role="header">
          <a data-rel="back" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
          <h1 data-localize="diary-edit-title"></h1>
        </div>
        <div data-role="main" class="ui-content">
          <h3 id="diaryItemName"></h3>
            <form onsubmit="editDiaryItemFormAction(); return false;" id="editDiaryItemForm">
            <input type="hidden" id="id"> <!--The ID of the diary entry being edited-->
            <input type="hidden" id="calories">
            <label id="caloriesDisplayLabel" for="caloriesDisplay" data-localize="calories"></label>
            <p id="caloriesDisplay"></p>
            <label for="quantity" data-localize="num-servings"></label>
            <input type="number" name="quantity" id="quantity" step="any" required="true">
            <label for="category" data-localize="category"></label>
            <select name="category" id="category" data-native-menu="false">
              <option value="Breakfast" data-localize="breakfast"></option>
              <option value="Lunch" data-localize="lunch"></option>
              <option value="Dinner" data-localize="dinner"></option>
              <option value="Snacks" data-localize="snacks"></option>
            </select>
            <button type="submit" id="saveDiaryItem" name="saveDiaryItem" data-localize="save"></button>
          </form>
        </div>
      </div>

      <!--Statistics page -->
      <div data-role="page" id="statsPage">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">
          <a href="#home" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
          <h1 data-localize="stats"></h1>
        </div>
        <div data-role="main" class="ui-content">
          <select name="range" id="range" data-native-menu="false">
            <option value="week" data-localize="week"></option>
            <option value="month" selected="selected" data-localize="month"></option>
            <option value="3month" data-localize="3month"></option>
            <option value="6month" data-localize="6month"></option>
            <option value="12month" data-localize="12month"></option>
          </select>
          <canvas id="weightChart" height="200" width="300"></canvas>
          <ul data-role="listview" id="weightLog"></ul>
        </div>
      </div>

      <!--Food list page -->
      <div data-role="page" id="foodListPage">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">
          <a href="#home" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
          <h1 data-localize="food-list"></h1>
          <a id="addFood" class="ui-btn ui-icon-plus ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
        </div>
        <div data-role="main" class="ui-content">
          <form class="ui-filterable">
            <input type="text" data-type="search" id="filterFoodList">
            <input type="hidden" id="category" value=""/>
          </form>
          <ul data-role="listview" class="ui-nodisc-icon ui-alt-icon"  id="foodListview" data-filter="true" data-input="#filterFoodList" data-split-icon="edit">
          </ul>
        </div>
        <div data-role="popup" id="deleteFoodListItemPopup">
          <div data-role="header">
            <h1 data-localize="delete-title"></h1>
          </div>
          <div data-role="main" class="ui-content">
            <p data-localize="confirm-delete"></p>
            <a data-role="button" id="cancel" data-rel="back" data-localize="cancel"></a>
            <button data-role="button" data-localize="delete"></button>
          </div>
        </div>
      </div>

      <!--Add/Edit food page -->
      <div data-role="page" id="editFoodPage">
        <div data-role="header">
          <a href="#foodListPage" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
          <h1 data-localize="add-food"></h1>
          <a href="javascript:scan();" class="ui-btn ui-icon-camera ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
        </div>
        <div data-role="main" class="ui-content">
          <form onsubmit="addFoodFormAction(); return false;" id="editFoodForm">
            <input type="hidden" id="foodId" value="">
            <input type="hidden" id="barcode" value="">

            <label for="foodName" data-localize="name-of-food"></label>
            <input type="text" name="foodName" id="foodName" required="true" placeholder="">

            <label for="foodPortion" data-localize="portion"></label>
            <input type="text" name="foodPortion" id="foodPortion" required="true" placeholder="">

            <label for="foodCalories" data-localize="calories"></label>
            <input type="number" pattern="[0-9]*" name="foodCalories" id="foodCalories" required="true" placeholder="">

            <button type="submit" name="saveFood" data-localize="save">Save</button>
          </form>
          <div id="foodImage"><img></img></div>
        </div>
      </div>

      <!--Settings page -->
      <div data-role="page" id="settingsPage">
        <div data-role="header">
          <a href="index.html" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
          <h1 data-localize="settings"></h1>
        </div>
        <div data-role="main" class="ui-content">
          <form onsubmit="saveUserSettings(); return false;" id="settingsForm">

            <label for="weight" data-localize="current-weight"></label>
            <input type="number" name="weight" id="weight">

            <label for="calorie-goal" data-localize="calorie-goal"></label>
            <input type="number" name="calorieGoal" id="calorieGoal">

            <label for="goalIsMin" data-localize="goal-is-min"></label>
            <input type="checkbox" name="goalIsMin" id="goalIsMin">

            <label for="scanImages" data-localize="scan-images"></label>
            <input type="checkbox" name="scanImages" id="scanImages">

            <button type="submit" name="saveSettings" data-localize="save"></button>
          </form>
        </div>
      </div>

      <!--User Guide Page -->
      <div data-role="page" id="guidePage">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">
          <a href="index.html" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-nodisc-icon"></a>
          <h1 data-localize="instructions"></h1>
        </div>
        <div data-role="main" class="ui-content">
          <div data-localize="userguide-basics"></div>
          <div data-localize="userguide-diary"></div>
          <div data-localize="userguide-statistics"></div>
          <div data-localize="userguide-foodlist"></div>
          <div data-localize="userguide-adding-a-food"></div>
          <div data-localize="userguide-settings"></div>
          <div data-localize="userguide-export"></div>
          <div data-localize="userguide-import"></div>
          <div data-localize="userguide-license"></div>
        </div>
      </div>

      <script type="text/javascript" src="cordova.js"></script>
      <script type="text/javascript" src="js/db-handler.js"></script>
      <script src="js/jquery.localize.min.js"></script> <!-- Localisation -->
      <script type="text/javascript" src="js/index.js"></script>
    </body>
</html>
